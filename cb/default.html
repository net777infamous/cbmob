<!DOCTYPE html>
<html>
<head>
    <title>Video.js Player</title>
    <link href="https://vjs.zencdn.net/7.14.3/video-js.css" rel="stylesheet">
    <script src="https://vjs.zencdn.net/7.14.3/video.js"></script>
    <style>
        #container {
            position: relative;
    top: 50%;
            display: flex;
            height: 85vh;
            flex-direction: column; /
        }
        body {
    background-color: black;
}
        #videoPlayer {
            flex: 1;
            padding: 3px;
        }

        .video-js {
            width: 100% !important;
            height: 100% !important;
        }
        
        #otherContent {
            flex: 1;
            background-color: black;
            overflow-y: auto;
        }

        #usernameContainer {
            padding: 10px;
            color: white;
            background-color: black;
            
        }

        #pageNumber {
            color: white; /* Set the color to white */
        }

        .clickable {
            cursor: pointer;
            text-decoration: underline;
            margin-bottom: 10px;
            display: inline-block;
            /*width: 20%;*/
            text-align: center;
            font-size: 18px;
        }

        .thumbnail {
            display: block;
            width: 185px;
            height: 170px;
            background-size: cover;
            margin-bottom: 5px;
        }

        .previous-button {
    background-color: #007BFF;
    color: white;
    border: none;
    padding: 15px 100px;
    cursor: pointer;
    border-radius: 5px;
    font-size: 16px;
}

.next-button {
    background-color: #28A745;
    color: white;
    border: none;
    padding: 15px 100px;
    cursor: pointer;
    border-radius: 5px;
    font-size: 16px;
}

.page-button {
    background-color: red;
    color: white;
    border: none;
    padding: 15px 70px;
    cursor: pointer;
    border-radius: 5px;
    font-size: 16px;
}

.page-number {
    font-size: 25px; /* Adjust the font size for the number */
}

.mute-button {
    background-color: purple;
    color: white;
    border: none;
    padding: 15px 70px;
    cursor: pointer;
    border-radius: 5px;
    font-size: 16px;
}

        
#volumeSlider {
    width: 98%; 
    margin-top: 20px; 
    
}
#myDiv {
    color: white;
    margin-top: 25px;
    text-align: center;
}

    </style>
    <script>
        var offset = 0;
        var pagex = 1;


            

        

     function getJSON(offset) {
    fetch(`https://chaturbate.com/api/public/affiliates/onlinerooms/?wm=ypOeP&format=json&client_ip=172.70.54.110&tour=41Ea&limit=20&gender=f&offset=${offset}`)
        .then(function(response) {
            return response.json();
        })
        .then(function(data) {
            var usernames = data.results.map(function(result) {
                return result.username;
            });
            
            var locations = data.results.map(function(result) {
                return result.location;
            });
            var nfollowers = data.results.map(function(result) {
                return result.num_followers;
                 
            });

            var counts = data.map(function(result) {
            return result.count;
                
        });
alert (counts)
           
            
            var usernameElement = document.getElementById('username');
            var divElement = document.getElementById("myDiv");
            
            divElement.innerHTML = '';
            
            usernameElement.innerHTML = usernames.map(function(username, index) {
                var fontSize = (username.length > 10) ? '12px' : '18px';
                return `
                    <div class="clickable" data-location="${locations[index]}" userinfo="${username}" nfollow="${nfollowers[index]}">
                        <img class="thumbnail" src="https://cbjpeg.stream.highwebmedia.com/minifwap/${username}.jpg?f=${Date.now()}" alt="${username} Thumbnail">
                        <div style="font-size: ${fontSize};">${username}</div>
                        <div style="display: none;">${locations[index]}</div>
                    </div>`;
            }).join("");

            var videoElement = document.getElementById('myVideo');
            var player = videojs(videoElement);

            var locationDivs = divElement.getElementsByClassName('xlickable');

            var usernameDivs = usernameElement.getElementsByClassName('clickable');
            for (var i = 0; i < usernameDivs.length; i++) {
                var div = usernameDivs[i];
                div.addEventListener('click', function(event) {
                    var clickedUsername = event.currentTarget.getAttribute('userinfo');
                 //   var xviews = event.currentTarget.getAttribute('vcount');
                    var xfollow = event.currentTarget.getAttribute('nfollow');
                    divElement.innerHTML = '';

                    var clickedLocation = event.currentTarget.getAttribute('data-location');

                    divElement.innerHTML ='location:  '+ clickedLocation +'                                                 followers:  '+xfollow;

                    player.src([{
                        src: 'https://edge8-hel.live.mmcdn.com/live-hls/amlst:' + clickedUsername + '/playlist.m3u8',
                        type: 'application/x-mpegURL'
                    }]);
                    player.play();
                });
            }
        })
        .catch(function(error) {
            console.log('Error:', error);
        });
}


        
        function previous() {
            offset -= 19;
            pagex -= 1;
            if (pagex < 1) {
                pagex = 1
            }
            
            console.log("page no "+pagex)
            updatePageNumber();
            if (offset < 0) {
                offset = 0;
            }
            clearUsernames();
            getJSON(offset);
        }
        
        function next() {
            offset += 20;
            pagex += 1;
            console.log("page no "+pagex)
            updatePageNumber();
            clearUsernames
            clearUsernames();
            getJSON(offset);
        }
        function updatePageNumber() {
            var pageNumberElement = document.getElementById('pageNumber');
            pageNumberElement.textContent = `(${pagex})`;
        }
        
        function clearUsernames() {
            var usernameElement = document.getElementById('username');
            usernameElement.innerHTML = "";
        }
        function redirectToOtherPage() {
            var currentPage = window.location.href;

            if (currentPage === "https://net777infamous.github.io/cbmob/cb/default.html") {
                window.location.href = "https://net777infamous.github.io/cbmob/cb/ebony.html";
            } else {
                window.location.href = "https://net777infamous.github.io/cbmob/cb/default.html";
            }
        }

        document.addEventListener("DOMContentLoaded", function() {
            getJSON(offset);
        });

        let touchstartX = 0;
let touchendX = 0;

document.addEventListener("touchstart", function(event) {
    if (!event.target.closest('#volumeSlider')) {
        touchstartX = event.touches[0].clientX;
    }
});

document.addEventListener("touchend", function(event) {
    if (!event.target.closest('#volumeSlider')) {
        touchendX = event.changedTouches[0].clientX;
        handleSwipe();
    }
});

function handleSwipe() {
    const threshold = 50;
    const deltaX = touchstartX - touchendX;

    if (deltaX > threshold) {
        next(); // Right swipe (next function)
    } else if (-deltaX > threshold) {
        previous(); // Left swipe (previous function)
    }
}

window.onload = function() {
starty()
}
        function starty() {
       var videoElement = document.getElementById('myVideo');
    var player = videojs(videoElement); 
    const volumeSlider = document.getElementById('volumeSlider');
//volumeSlider.style.display = "none";

const muteButton = document.getElementById('muteButton');

    var playerContainer = player.el();
playerContainer.click();

apiUrl = "https://chaturbate.com/api/public/affiliates/onlinerooms/?wm=ypOeP&format=json&client_ip=172.70.54.110&tour=41Ea&limit=1&gender=f";

fetch(apiUrl)
  .then(response => response.json())
  .then(data => {
    data.results.forEach(result => {
        player.src([{
                                src: 'https://edge8-hel.live.mmcdn.com/live-hls/amlst:' + result.username + '/playlist.m3u8',
                                type: 'application/x-mpegURL'
                            }]);
                            player.play();
    });
  }); 


    player.on('pause', function() {
        player.play().catch(function(error) {
            console.error('Failed to play video:', error);
        });
    });

    volumeSlider.addEventListener('input', function() {
        if (player.paused()) {
                player.play();
            }
        if (player.play()) {
                player.play();
            }
  if (muteButton.textContent == 'Unmute') {
     player.muted(false);
        player.volume(volumeSlider.value);
        muteButton.textContent = 'Mute';
      if (player.paused()) {
                player.play();
            }

    }
 else if (muteButton.textContent == 'Mute') {
        player.volume(volumeSlider.value);
     if (player.paused()) {
                player.play();
            }

}
    });
};


let isMuted = false;

function toggleMute() {

    var videoElement = document.getElementById('myVideo');
var player = videojs(videoElement);
const muteButton = document.getElementById('muteButton');
const volumeSlider = document.getElementById('volumeSlider');


    if (muteButton.textContent == 'Mute') {
        player.muted(true);
        muteButton.textContent = 'Unmute';
      //  volumeSlider.style.display = "none";
    } else if (muteButton.textContent == 'Unmute') {
        player.muted(false);
        player.volume(volumeSlider.value);
        muteButton.textContent = 'Mute';
      //  volumeSlider.style.display = "block";
    }
  //  isMuted = !isMuted;
}
function slide() {
       var videoElement = document.getElementById('myVideo');
var player = videojs(videoElement);
const muteButton = document.getElementById('muteButton');

    if (muteButton.textContent == 'Unmute') {
        player.muted(false);
        player.volume(volumeSlider.value);
        muteButton.textContent = 'Mute';
    }
}

    </script>
</head>
<body>
    <div id="container">
        <div id="videoPlayer">
            <video id="myVideo" class="video-js vjs-default-skin" controls preload="auto" muted autoplay style="object-fit: fill;">
                <source src="monkeylina.mp4"></source>
            </video>
        </div>
        <div id="otherContent">
            <div id="usernameContainer">
                <div id="username"></div>
            </div>
            <!-- Add your other content here -->
        </div>
    </div>
    <button class="previous-button" onclick="previous()">Previous</button>
<button class="next-button" onclick="next()">Next</button>

<div class="page-number" id="pageNumber" style="color: white; display: inline-block; margin-left: 15px; margin-right: 15px;">(1)</div>
    <button class="page-button" onclick="redirectToOtherPage()">Other</button>

     <button class="mute-button"  id="muteButton" onclick="toggleMute()">Unmute</button>
      <div id="volumeControl">
          <div id="myDiv" class="myClass"> </div>
        <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="0.2" onclick="slide()">
    </div>
    
</body>
</html>
